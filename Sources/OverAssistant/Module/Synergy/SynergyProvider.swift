//
//  SynergyProvider.swift
//  
//
//  Created by Александр Губанов on 17.10.2020.
//

import Foundation

class SynergyProvider {
    
    /**
     Represented by N x N matrix, that shows synergy relationship between each hero
     
     Numbers in matrix means the strength of synergy and can take value from 0 to 2. Value of zero means that heroes have no synergy. Value of two means that heroes have the strongest synergy.
     */
    private static var synergyMatrix: [[Int]] = [
        [0,0,0,0,0, 0,0,0,10,20, 0,0,15,0,0, 0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0, 0,0],
        [0,0,0,0,10, 0,0,0,0,0, 0,0,25,0,0, 0,0,0,0,0, 0,25,0,0,0, 0,25,0,0,0, 0,0],
        [0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0, 0,0],
        [0,0,0,0,0, 45,0,0,0,30, 0,0,10,0,0, 0,0,0,0,0, 0,15,0,0,0, 0,0,0,0,0, 0,0],
        [0,10,0,0,0, 25,30,0,0,10, 45,0,10,10,15, 10,0,15,0,0, 0,15,0,0,0, 15,20,0,10,15, 0,0],

        [0,0,0,45,25, 0,0,0,30,0, 45,0,20,10,10, 0,10,15,25,0, 10,0,10,25,10, 0,0,20,10,0, 0,0],
        [0,0,0,0,30, 0,0,0,10,0, 0,10,0,0,0, 0,0,0,0,0, 0,0,0,45,0, 0,0,0,0,0, 0,0],
        [0,0,0,0,0, 0,0,0,0,0, 0,0,15,0,0, 0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0, 0,0],
        [10,0,0,0,0, 30,10,0,0,10, 0,0,15,0,10, 15,0,0,0,0, 0,15,0,0,0, 0,20,0,0,10, 0,0],
        [20,0,0,30,10, 0,0,0,10,0, 15,0,0,10,0, 0,10,10,15,0, 25,0,10,15,10, 0,10,15,10,0, 0,0],

        [0,0,0,0,45, 45,0,0,0,15, 0,10,10,0,0, 10,0,0,0,0, 0,15,0,40,0, 15,10,0,0,20, 0,0],
        [0,0,0,0,0, 0,10,0,0,0, 10,0,0,0,0, 0,0,0,0,0, 0,0,0,10,0, 0,0,0,0,0, 0,0],
        [15,25,0,10,10, 20,0,15,15,0, 10,0,0,0,0, 5,5,5,5,0, 0,10,0,5,5, 0,10,5,5,10, 0,0],
        [0,0,0,0,10, 10,0,0,0,10, 0,0,0,0,0, 5,0,0,0,0, 0,0,0,0,0, 0,5,0,0,10, 0,0],
        [0,0,0,0,15, 10,0,0,10,0, 0,0,0,0,0, 0,0,0,10,0, 5,0,0,15,0, 0,0,0,0,10, 0,0],

        [0,0,0,0,10, 0,0,0,15,0, 10,0,5,5,0, 0,0,10,10,0, 10,0,5,10,10, 0,5,10,10,0, 0,0],
        [0,0,0,0,0, 10,0,0,0,10, 0,0,5,0,0, 0,0,0,0,0, 0,20,5,0,0, 5,0,10,0,15, 0,0],
        [0,0,0,0,15, 15,0,0,0,10, 0,0,5,0,0, 10,0,0,0,0, 0,10,0,0,0, 10,10,0,0,15, 0,0],
        [0,0,0,0,0, 25,0,0,0,15, 0,0,5,0,10, 10,0,0,0,0, 0,10,0,0,0, 10,5,0,0,10, 0,0],
        [0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0, 0,0,5,0,10, 0,0,0,5,0, 0,0],

        [0,0,0,0,0, 10,0,0,0,25, 0,0,0,0,5, 10,0,0,0,0, 0,5,0,0,0, 5,5,0,0,5, 0,0],
        [0,25,0,15,15, 0,0,0,15,0, 15,0,10,0,0, 0,20,10,10,0, 5,0,0,10,5, 0,5,10,10,0, 0,0],
        [0,0,0,0,0, 10,0,0,0,10, 0,0,0,0,0, 5,5,0,0,5, 0,0,0,0,0, 5,5,0,0,5, 0,0],
        [0,0,0,0,0, 25,45,0,0,15, 40,10,5,0,15, 10,0,0,0,0, 0,10,0,0,0, 10,10,0,0,10, 0,0],
        [0,0,0,0,0, 10,0,0,0,10, 0,0,5,0,0, 10,0,0,0,10, 0,5,0,0,0, 5,5,0,0,5, 0,0],

        [0,0,0,0,15, 0,0,0,0,0, 15,0,0,0,0, 0,5,10,10,0, 5,0,5,10,5, 0,0,10,10,0, 0,0],
        [0,25,0,0,20, 0,0,0,20,10, 10,0,10,5,0, 5,0,10,5,0, 5,5,5,10,5, 0,0,10,5,5, 0,0],
        [0,0,0,0,0, 20,0,0,0,15, 0,0,5,0,0, 10,10,0,0,0, 0,10,0,0,0, 10,10,0,0,10, 0,0],
        [0,0,0,0,10, 10,0,0,0,10, 0,0,5,0,0, 10,0,0,0,5, 0,10,0,0,0, 10,5,0,0,10, 0,0],
        [0,0,0,0,15, 0,0,0,10,0, 20,0,10,10,10, 0,15,15,10,0, 5,0,5,10,5, 0,5,10,10,0, 0,0],
        
        [0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0, 0,0],
        [0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0, 0,0]
    ]
    
    private static var synergyRecords: [DuoSynergy: SynergyClass] = [
        DuoSynergy("pharah", "mercy")! : .playStyleBased(value: .undeniable)
    ]
    
    static func getSynergy(between firstHero: Hero, and secondHero: Hero) -> SynergyClass? {
        guard let synergyKey = DuoSynergy(firstHero.id, secondHero.id) else {
            return nil
        }
        if let synergy = synergyRecords[synergyKey] {
            return synergy
        } else if synergyMatrix[firstHero.number - 1][secondHero.number - 1] > 0 {
            return .abilityBased(value: .good)
        } else {
            return nil
        }
    }
}
